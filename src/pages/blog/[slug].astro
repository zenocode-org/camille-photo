---
import MainLayout from '../../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import { ArrowLeft } from 'lucide-astro';

export async function getStaticPaths() {
	const blogPosts = await getCollection('blog');
	return blogPosts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<MainLayout>
	<section class="pt-32 pb-20">
		<div class="container-custom">
			<div class="max-w-4xl mx-auto">
				<a
					href="/blog"
					class="inline-flex items-center gap-2 text-gray-700 hover:text-black transition-colors mb-6 group"
				>
					<ArrowLeft size={20} class="group-hover:-translate-x-1 transition-transform" />
					<span>Retour au blog</span>
				</a>

				<article class="bg-white rounded-lg shadow-md overflow-hidden">
					<div class="p-8 md:p-12">
						<h1 class="text-4xl md:text-5xl font-bold mb-4">{post.data.title}</h1>
						<p class="text-xl text-gray-600 mb-6">{post.data.description}</p>
						<time class="text-sm text-gray-500 block mb-8">
							{new Date(post.data.date).toLocaleDateString('fr-FR', {
								year: 'numeric',
								month: 'long',
								day: 'numeric',
							})}
						</time>

						{post.data.images && post.data.images.length > 0 && (
							<div class="mb-8 space-y-6">
								{post.data.images.map((image) => (
									<div class="relative w-full rounded-lg overflow-hidden shadow-lg">
										<img
											src={`/gallery/${image.path}`}
											alt={image.alt}
											class="w-full h-auto object-cover"
										/>
									</div>
								))}
							</div>
						)}

						<div class="prose prose-lg max-w-none text-gray-700">
							<Content />
						</div>
					</div>
				</article>
			</div>
		</div>
	</section>
</MainLayout>
